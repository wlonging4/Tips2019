$(document).ready(function(){var e,t,s,a=$("#riskQuestionType").val(),i=$("#xinghuo-app-token").val(),n=$("#sesameSource").val();switch(a){case"wallet":e=$("#token").val(),t="/mobile/appRisk/creteWalletRiskAssess.json",s={0:"未测评",1:"安益型",2:"保守型",3:"稳健型",4:"积极型",5:"进取型"};break;case"sesameProduct":e=i,t="/mobile/appsesame/riskQuestionSubmit.shtml",s={0:"未测评",1:"保守型",2:"稳健型",3:"平衡型",4:"进取型",5:"激进型"};break;case"xinghuoPlan":e=i,t="/mobile/appsesame/riskQuestionSubmitXinghuoPlan.shtml",s="8"==n?{0:"未测评",1:"保守型",2:"平衡型",3:"稳健型",4:"进取型",5:"激进型"}:{0:"未测评",1:"保守型",2:"稳健型",3:"平衡型",4:"进取型",5:"激进型"}}var o={result:[],submitFlag:!0,bindEvent:function(){var e=this.result,t=this.verify,s=$("#submit-btn");$(document).on("change","#questions-list input[type='radio'], #questions-list input[type='checkbox']",function(){var a=$(this).attr("name"),i=a.replace(/risk/,"")-1,n=$(this).attr("type"),o=$(this).val();if("radio"==n)o=$(this).val(),e[i]=o;else{var l=$("input[name= "+a+"]:checked");e[i]="",l.length>0&&l.each(function(t,s){e[i]+=s.value})}t(e)?s.removeClass("disable"):s.addClass("disable")}),("wallet"===a||"sesameProduct"===a)&&$(document).on("touchstart",".risk-xieyi",function(){var a=$(".checkIcon");a.hasClass("active")?a.removeClass("active"):a.addClass("active"),t(e)?s.removeClass("disable"):s.addClass("disable")});var i=!0;$(document).on("touchstart","#sesame-questions-shuzizhengshu-protocol",function(e){var t=$(this).attr("data-href");return i&&(i=!1,$.ajax({url:t,type:"POST",success:function(e){if(1==e.code){var t=new Modal({title:e.data.protocolTitle,wrapperClass:"dialog2",contentText:e.data.protocolContent,isClosebtn:!0});t.open()}else{var t=new Modal({wrapperClass:"dialog1",contentText:e.msg,isTipConfirm:!0});t.open()}i=!0},error:function(){i=!0}})),e.stopPropagation(),("sesameProduct"===a||"xinghuoPlan"===a)&&e.preventDefault(),!1})},verify:function(e){for(var t=e.length,s=!0,i=0;t>i;i++)if(!e[i]){s=!1;break}return"sesameProduct"!==a||$(".checkIcon").hasClass("active")||(s=!1),s},submitAnswers:function(){var i=this,o=this.result,l=this.verify;$("#submit-btn").on("click",function(){if(!l(o))return!1;var r=$.map(o,function(e,t){return"wallet"===a?e:parseInt(t+1)+"|"+e});if(i.submitFlag){var c='<div class="loadingDiv"></div>';$("body").append(c);var u={answer:r.join(","),token:e};"xinghuoPlan"===a&&(u.assessmentType=n),$.ajax({url:t,type:"POST",data:u,success:function(t){if($(".loadingDiv").remove(),1==t.code||1==t.success){var o=t.data;if("wallet"===a&&"list"==$("#type").val())return void(location.href="/mobile/appRisk/getAppPublicFundsRiskResult.shtml?token="+e);var l=!0,r={title:"您的风险偏好类型为",wrapperClass:"dialog4",contentText:"<div class='orangeWord'>"+s[o.riskType]+"</div>",isPromptbtn:!0,conisPromptText:["转入","取消"],conisPromptLink:[l?"xinghuo://RiskWalletEnter":"","xinghuo://RiskWalletCancle"],conisPromptClass:[l?"":"disable",""]},c={title:"您的风险偏好类型为",wrapperClass:"dialog3",contentText:"<div class='orangeWord'>"+s[o.riskLevel]+"</div>"+o.detailRemark,isConfirmbtn:!0,confirmText:"预约产品",maskNoClickClose:!0,callback:function(){var e=$("#xinghuo-app-sesameCode");location.href="xinghuo://GoToSesameInfo?sesameCode="+(e.val()||"")}},u="wallet"===a?r:c;switch(a){case"wallet":var d=new Modal(u);d.open(),[].slice.call(document.querySelectorAll(".twoBtn")).forEach(function(e,t){e.addEventListener("click",function(){e.classList.add("touchbtn"),setTimeout(function(){e.classList.remove("touchbtn")},500)},!1)});break;case"xinghuoPlan":var p=$("#xinghuo-app-sesameCode").val();if(""!=p&&void 0!=p){var d=new Modal(u);return void d.open()}location.href="/mobile/apppersonal/riskResult.shtml?token="+e+"&assessmentType="+n;break;case"sesameProduct":var d=new Modal(u);d.open()}}else{var d=new Modal({wrapperClass:"dialog1",contentText:"wallet"===a?"请求失败":t.msg,isTipConfirm:!0});d.open()}i.submitFlag=!0},error:function(){i.submitFlag=!0}})}})},init:function(){this.result.length=$("#questions-list").find("li").length,this.bindEvent(),this.submitAnswers()}};o.init()});