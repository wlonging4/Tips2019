function bodyScroll(){useList.bodyScroll()}apphasHeader(),Tips.init(),Loading.init();var useList={pageNo:1,pageSize:20,init:function(e,t){this.headerBox=e,this.listBox=t,this.headData(),this.listData()},headData:function(){var e=this,t=e.redPacketStoreId,a=JSON.stringify({redPacketStoreId:t});xhReqDataHandleFn(a,useList,"loadData")},redPacketStoreId:getQueryString(getQueryString("redPacketId")?"redPacketId":"redPacketStoreId"),redPacketId:getQueryString("redPacketTemplateId")?getQueryString("redPacketTemplateId"):"",loadData:function(e){var t=this;e={data:e},$.ajax({url:"/webapi/capp/redpacket/store/get.ason",type:"POST",async:!0,cache:!1,dataType:"JSON",data:e,success:function(e){if("1"==e.code){e.data.redPacketStoreId=t.redPacketStoreId,useList.headerHtml(e.data);var a=e.data.redName;appSetWebTitle(a)}},error:function(e){}})},listData:function(){var e=this,t=e.redPacketStoreId,a=e.redPacketId,o=JSON.stringify({redPacketStoreId:t,redPacketId:a,pageNo:e.pageNo,pageSize:e.pageSize});xhReqDataHandleFn(o,useList,"loadList")},loadList:function(e){var t=this;e={data:e},this.bodyScrollUnBind(),$.ajax({url:"/webapi/capp/redpacket/store/redPacketUse.ason",type:"POST",async:!0,cache:!1,dataType:"JSON",data:e,success:function(e){if("1"==e.code){if(0==e.data.list.length)return;useList.listHtml(e.data.list),t.pageNo==e.data.totalPage||t.pageNo>e.totalPage?t.bottomLoadHide():(t.bodyScrollBind(),t.pageNo=t.pageNo+1)}else"5001"==e.code&&appToLogin()},error:function(e){}})},headerHtml:function(e){this.headerBox.innerHTML=tmpl("js_headerTmpl",{item:e})},listHtml:function(e){for(var t=0;t<e.length;t++)e[t].lastGetTime=this.getDateYYMMDD(e[t].lastGetTime);this.listBox.innerHTML+=tmpl("js_listTmpl",{items:e})},dataProcess:function(e){},bottomLoadShow:function(){$(".loadingBox").removeClass("hide"),$(".loadingBox").addClass("show")},bottomLoadHide:function(){$(".loadingBox").removeClass("show"),$(".loadingBox").addClass("hide")},bodyScroll:function(){var e=this;e.bottomLoadShow();var t=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,a=document.documentElement.scrollHeight,o=document.documentElement.clientHeight;t+o>a-60&&e.listData()},bodyScrollBind:function(){document.addEventListener("scroll",bodyScroll,!1)},bodyScrollUnBind:function(){document.removeEventListener("scroll",bodyScroll,!1)},getDateYYMMDD:function(e){return dateObj=new Date(e),dateYear=dateObj.getFullYear(),dateMon=dateObj.getMonth()+1,dateMon=dateMon<10?"0"+dateMon:dateMon,dateDay=dateObj.getDate(),dateDay=dateDay<10?"0"+dateDay:dateDay,dateStr=dateYear+"-"+dateMon+"-"+dateDay,dateStr}};window.onload=function(){var e=document.querySelector(".js_header"),t=document.querySelector(".js_list");useList.init(e,t)};